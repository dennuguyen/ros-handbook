<?xml version="1.0" ?>
<robot name="claw" xmlns:xacro="http://ros.org/wiki/xacro">

  <xacro:macro name="claw" params="prefix parent *origin">

    <joint name="${prefix}claw_flange" type="fixed">
      <parent link="${parent}"/>
      <child link="${prefix}base_link"/>
      <xacro:insert_block name="origin"/>
    </joint>

    <link name="${prefix}base_link">
      <visual>
        <geometry>
          <mesh filename="package://claw_description/meshes/base_link.STL"/>
        </geometry>
        <origin xyz="0 0 0.025" rpy="1.5707963 0 0"/>
      </visual>
      <collision>
        <geometry>
          <mesh filename="package://claw_description/meshes/base_link.STL"/>
        </geometry>
        <origin xyz="0 0 0.025" rpy="1.5707963 0 0"/>
      </collision>
      <inertial>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <mass value="0.268"/>
        <inertia
          ixx="1.0" ixy="0.0" ixz="0.0"
          iyy="1.0" iyz="0.0"
          izz="1.0"/>
      </inertial>
    </link>

    <joint name="${prefix}joint1" type="continuous">
      <origin xyz="0.05251 -0.010729 -0.0375" rpy="-1.5708 ${pi} 3.1416"/>
      <parent link="${prefix}base_link"/>
      <child link="${prefix}claw1"/>
      <axis xyz="0 0 1"/>
      <dynamics damping="0.1" friction="0.1"/>
    </joint>

    <joint name="${prefix}joint2" type="continuous">
      <parent link="${prefix}base_link"/>
      <child link="${prefix}claw2"/>
      <axis xyz="0 0 1"/>
      <origin xyz="-0.01693 0.050862 -0.0375" rpy="-1.5708 ${pi} -1.0472"/>
      <mimic joint="joint1" multiplier="1" offset="0"/>
    </joint>

    <joint name="${prefix}joint3" type="continuous">
      <parent link="${prefix}base_link"/>
      <child link="${prefix}claw3"/>
      <axis xyz="0 0 1"/>
      <origin xyz="-0.03555 -0.040071 -0.0375" rpy="-1.5708 ${pi} 1.0472"/>
      <mimic joint="joint1" multiplier="1" offset="0"/>
    </joint>

    <link name="${prefix}claw1">
      <visual>
        <geometry>
          <mesh filename="package://claw_description/meshes/claw1.STL"/>
        </geometry>
        <origin xyz="0 0 0" rpy="0 0 0"/>
      </visual>
      <collision>
        <geometry>
          <mesh filename="package://claw_description/meshes/claw1.STL"/>
        </geometry>
        <origin xyz="0 0 0" rpy="0 0 0"/>
      </collision>
      <!-- Some inertia values have to be non-zero for this link to render in Gazebo. We set ixx, iyy, izz to 1.0 -->
      <inertial>
        <origin xyz="-0.0185468224648669 0.110151443507784 -0.0107513372089238" rpy="0 0 0"/>
        <mass value="0.105"/>
        <inertia
          ixx="1.0" ixy="0.0" ixz="0.0"
          iyy="1.0" iyz="0.0"
          izz="1.0"/>
      </inertial>
    </link>

    <link name="${prefix}claw2">
      <visual>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="package://claw_description/meshes/claw2.STL"/>
        </geometry>
      </visual>
      <collision>
        <geometry>
          <mesh filename="package://claw_description/meshes/claw2.STL"/>
        </geometry>
        <origin xyz="0 0 0" rpy="0 0 0"/>
      </collision>
      <inertial>
        <origin xyz="-0.0185453798911736 0.110154432687198 -0.0107488890606977" rpy="0 0 0"/>
        <mass value="0.105"/>
        <inertia
          ixx="1.0" ixy="0.0" ixz="0.0"
          iyy="1.0" iyz="0.0"
          izz="1.0"/>
      </inertial>
    </link>

    <link name="${prefix}claw3">
      <visual>
        <geometry>
          <mesh filename="package://claw_description/meshes/claw3.STL"/>
        </geometry>
        <origin xyz="0 0 0" rpy="0 0 0"/>
      </visual>
      <collision>
        <geometry>
          <mesh filename="package://claw_description/meshes/claw3.STL"/>
        </geometry>
        <origin xyz="0 0 0" rpy="0 0 0"/>
      </collision>
      <inertial>
        <origin xyz="-0.0185427568586984 0.110154942459749 -0.0107492179371289" rpy="0 0 0"/>
        <mass value="0.105"/>
        <inertia
          ixx="1.0" ixy="0.0" ixz="0.0"
          iyy="1.0" iyz="0.0"
          izz="1.0"/>
      </inertial>
    </link>

    <!-- This block connects the joint to an actuator, which informs both simulation and visualization of the robot -->
    <transmission name="${prefix}joint1_trans">
      <type>transmission_interface/SimpleTransmission</type>
      <actuator name="${prefix}joint1_motor">
        <mechanicalReduction>1</mechanicalReduction>
      </actuator>
      <joint name="${prefix}joint1">
        <hardwareInterface>hardware_interface/EffortJointInterface</hardwareInterface>
      </joint>
    </transmission>

    <gazebo>
      <plugin name="${prefix}joint2_mimic_plugin" filename="libroboticsgroup_gazebo_mimic_joint_plugin.so">
        <joint>${prefix}joint1</joint>
        <mimicJoint>${prefix}joint2</mimicJoint>
      </plugin>
    </gazebo>

    <gazebo>
      <plugin name="${prefix}joint3_mimic_plugin" filename="libroboticsgroup_gazebo_mimic_joint_plugin.so">
        <joint>${prefix}joint1</joint>
        <mimicJoint>${prefix}joint3</mimicJoint>
      </plugin>
    </gazebo>

  </xacro:macro>
</robot>